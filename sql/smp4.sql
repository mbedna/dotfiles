SELECT a.* from (SELECT asp.AccountSuggestedProductID, asp.AccountID, asp.AccountApplicationCode,asp.ProductOfferServicesDetailID, asp.DateObtained, asp.ActivityTypeID,asp.LOCIncrease, asp.NLOC,asp.BaseValue, asp.FICOScoreRange, asp.PrimaryDisclosureGroup,asp.AlternateDisclosureGroup, asp.ValueSourceCode, asp.SourceValue, asp.CITCode,asp.Rank, asp.RTID,
posd.ProductCode, posd.ProductApplicationCode, posd.CampaignCode,posd.SolicitationCode, posd.OfferRate, posd.OfferRateExpirationDate,posd.FeeRate, posd.FeeMin, posd.FeeMax,posd.RollRate, posd.OfferExpirationDate, posd.RollType,posd.StartDate, posd.EndDate, posd.AcquisitionStrategyCode,posd.SpecialTerms,posd.OfferTypeID,posd.IncentiveBonus, posd.Duration, posd.Amount, posd.NoPurchase, posd.Combo, posd.TriggerTermsInfo, prd.Description, prd.MarketingText 
FROM Product prd, AccountSuggestedProduct_active asp, ProductOfferServicesDetail posd WHERE asp.AccountApplicationCode = 'TSYS' AND asp.AccountID=(select axr.AccountID from SRS_XREF axr where axr.accountnumber = 5121070103211500 ) AND asp.ProductOfferServicesDetailID = posd.ProductOfferServicesDetailID AND prd.Applicationcode = posd.ProductApplicationCode AND prd.ProductCode = posd.ProductCode AND (posd.OfferTypeID = 100 OR posd.OfferTypeID = 102 ) 
ORDER BY  asp.Rank DESC ) a, ASP_SUPPRESSION b WHERE a.accountid = b.accountid(+) AND( b.accountid is null or a.offertypeid not in ('300', '302', '303', '304', '306', '307', '308'))
;
